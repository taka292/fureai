<!-- app/views/chats/show.html.erb -->
<%= turbo_stream_from "#{dom_id(@chat)}_messages" %>
<div class="min-h-screen bg-gray-50 flex flex-col items-stretch">
  <!-- チャット全体のラッパー -->
  <div class="w-full flex flex-col flex-1 pb-24 bg-transparent">
    <!-- ヘッダー -->
    <div class="flex items-center justify-between bg-teal-100 rounded-t-lg px-4 py-3 mb-2">
      <!-- 戻るボタン -->
      <%= link_to chats_path, class: "flex items-center text-teal-700 hover:text-teal-900" do %>
        <svg class="w-6 h-6 mr-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
        </svg>
        <span class="hidden sm:inline">一覧へ</span>
      <% end %>
      <!-- AIキャラ名とアイコン -->
      <div class="flex items-center">
        <div class="w-10 h-10 rounded-full bg-gray-200 mr-3"></div>
        <span class="font-bold text-lg text-teal-800"><%= @chat.ai_character.name %></span>
      </div>
      <!-- 設定マーク（モック） -->
      <button class="text-teal-700 hover:text-teal-900 focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M12 6v6l4 2m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </button>
    </div>

    <!-- 日付区切り -->
    <div class="text-center text-xs text-gray-400 my-2">
      <%= @messages.first&.created_at&.strftime('%Y.%m.%d') %>
    </div>

    <!-- メッセージ一覧 -->
    <div id="<%= dom_id(@chat) %>_messages" class="space-y-2 flex-1 w-full px-2 py-4 overflow-y-auto">
      <%= render @messages %>
    </div>

    <!-- 入力欄 -->
    <%= render partial: "messages/form", locals: { chat: @chat } %>
  </div>
</div>